# Well
## VTP
### Общие сведения
VTP позволяет избавиться от вбивания вручную каждого VLAN на каждом коммутаторе. 

Каждый коммутатор в VTP может работать в одном из трех режимов:
- Server - режим по умолчанию, все изменения VLAN по транковым соединениям рассылаются всем коммутаторам внутри того же VTP домена;
- Client - на данном коммутаторе невозможно вносить изменения VLAN. Получаемые о VTP-сервера изменения VLAN применяются на данном коммутаторе и рассылаются остальным коммутаторам;
- Transparent - изменения внесенные на данном коммутаторе остаются внесенными только на нем и не распространияются далее. Получаемые от VTP-сервера изменения рассылаются остальным коммутаторам, но не прменяются на данном коммутаторе.

### Как настроить?
Всего три комманды, которые, если верить методичке необходимо писать в строго определенном порядке, как ниже (не проверял насколько правда).
#### Задание режима работы
В привелигированном режиме терминала конфигурации режим работы задается следующей командой:
```
Switch(config)#vtp mode client 
```
Соответственно вместо client можно указать server или transparent.
#### Задание домена
Задание домена равно заданию имени домена следующей командой:
```
Switch(config)#vtp domain domain_name
```
где вместо domain_name какое-либо имя домена
#### Задание пароля VTP
Используется как и имя домена для проверки что коммутатор которому пришли изменения дейсвительно в нужном домене. Задается командой:
```
Switch(config)#vtp password your_geniuos_secure_password
```

## STP

## Общие сведения
STP путем опроса окружающих коммутаторов позволяет построить остовное дерево в сети, чтобы исключить петли в сети. Петли физически вообще говоря нужны для отказоустойчисвотси, но логически их быть не должно.

## Как это работает

У портов в STP есть 4 роли:
- корневой;
- назначенный;
- доступа;
- заблокированный.

Первые две роли используются для передачи трафика в сегментах сети (**не** конечному устройству). Третья для передачи конечному устройству. При послденей как следует из названия ничего никуда не передается, такой порт логически отключенен.

Далее производятся следующие действия:

1. Выбирается корневой мост - коммутатор с минимальным идентификатором моста. Идентификатор моста равен сумме приоритета моста (32768 по умолчанию) и МAC адреса коммутатора. 
2. На корневом мосту каждый порт в роли назначенного.
3. У некорневых мостов (остальных коммутаторов) выбирается один корневой порт. Корневой порт предоставляет маршрут с минимальной стоимость к корневому мосту (то есть по этому порту в каком-то смысле дешевле всего до корня добраться). Стоимость маршрута определеяется полосой пропускания.
4. Для каждого сегмента выбирается назначенный порт. Назначенный порт выбирается на том некорневом мосту, который предоставляет минимальный маршрут к корневому мосту (то есть на коммутаторе выходящему на этот сегмент, с которого опять же в некотором смысле дешевле всего добраться до корня).
5. Все остальные порты блокируются.

О режимах работы портов PVST+, RSTP,PVRST+ и PortFast в методе.

## Как сделать
### Включить протокол PVRST+:
В привелигированном режиме конфигурации включить протокол PVRST+:
```
Switch(config)#spanning-tree mode rapid-pvst
```

(по идее включить его стоит на каждом коммутаторе)

### Сделать коммутатор основным корнем

Конкрентный коммутатор можно сделать основным корнем конкретной VLAN:
```
Switch(config)#spanning-tree vlan 50 root primary
```

### Сделать коммутатор вспомогательным корнем

Конкрентный коммутатор можно сделать вспомогательным корнем конкретной VLAN:
```
Switch(config)#spanning-tree vlan 50 root secondary
```

### Посмотреть инфу о дереве

Для конкретного vlan:
```
Switch#show spanning-tree 50
```
Для всех:
```
Switch#show spanning-tree
```